<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>fx-CG50 Web Calculator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.js"></script>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body {
      background: #2c2c2c;
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .calculator {
      background: #333;
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
      width: 420px;
    }
    .screen {
      background: #111;
      color: #0f0;
      font-family: monospace;
      height: 80px;
      padding: 10px;
      border-radius: 8px;
      margin-bottom: 10px;
      overflow-x: auto;
      white-space: nowrap;
    }
    .row {
      display: flex;
      justify-content: space-between;
      margin: 5px 0;
    }
    button {
      flex: 1;
      margin: 2px;
      padding: 12px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      cursor: pointer;
    }
    .func { background: #555; color: #fff; }
    .num { background: #eee; }
    .op { background: #ffa500; color: #000; }
    .mode { background: #0066cc; color: #fff; }
    .shift { background: yellow; }
    .alpha { background: red; color: #fff; }
    #graph { display:none; height:300px; }
  </style>
</head>
<body>
  <div class="calculator">
    <div id="screen" class="screen">fx-CG50 READY</div>
    <div id="graph"></div>

    <div class="row">
      <button class="mode" onclick="setMode('RUN')">RUN</button>
      <button class="mode" onclick="setMode('GRAPH')">GRAPH</button>
      <button class="mode" onclick="setMode('TABLE')">TABLE</button>
      <button class="mode" onclick="setMode('STAT')">STAT</button>
      <button class="mode" onclick="setMode('EQUA')">EQUA</button>
    </div>

    <div class="row">
      <button class="func">F1</button><button class="func">F2</button>
      <button class="func">F3</button><button class="func">F4</button>
      <button class="func">F5</button><button class="func">F6</button>
    </div>

    <div class="row">
      <button class="shift">SHIFT</button><button class="alpha">ALPHA</button>
      <button class="func" onclick="clearEntry()">DEL</button>
      <button class="func" onclick="clearAll()">AC</button>
    </div>

    <div class="row">
      <button class="func" onclick="append('sin(')">sin</button>
      <button class="func" onclick="append('cos(')">cos</button>
      <button class="func" onclick="append('tan(')">tan</button>
      <button class="func" onclick="append('^')">x^y</button>
    </div>

    <div class="row">
      <button class="num" onclick="append('7')">7</button>
      <button class="num" onclick="append('8')">8</button>
      <button class="num" onclick="append('9')">9</button>
      <button class="op" onclick="append('/')">÷</button>
    </div>
    <div class="row">
      <button class="num" onclick="append('4')">4</button>
      <button class="num" onclick="append('5')">5</button>
      <button class="num" onclick="append('6')">6</button>
      <button class="op" onclick="append('*')">×</button>
    </div>
    <div class="row">
      <button class="num" onclick="append('1')">1</button>
      <button class="num" onclick="append('2')">2</button>
      <button class="num" onclick="append('3')">3</button>
      <button class="op" onclick="append('-')">−</button>
    </div>
    <div class="row">
      <button class="num" onclick="append('0')">0</button>
      <button class="num" onclick="append('.')">.</button>
      <button class="func" onclick="append('pi')">π</button>
      <button class="op" onclick="append('+')">+</button>
    </div>
    <div class="row">
      <button class="func" onclick="append('(')">(</button>
      <button class="func" onclick="append(')')">)</button>
      <button class="func" onclick="append('sqrt(')">√</button>
      <button class="func" onclick="calculate()">EXE</button>
    </div>
  </div>

  <script>
    let mode = "RUN";
    let lastAns = 0;
    let input = "";

    function setMode(m) {
      mode = m;
      document.getElementById("screen").innerText = "Mode: " + m;
      if (m === "GRAPH") {
        document.getElementById("graph").style.display = "block";
      } else {
        document.getElementById("graph").style.display = "none";
      }
    }

    function append(val) {
      input += val;
      document.getElementById("screen").innerText = input;
    }

    function clearEntry() {
      input = input.slice(0, -1);
      document.getElementById("screen").innerText = input || "0";
    }

    function clearAll() {
      input = "";
      document.getElementById("screen").innerText = "0";
    }

    function calculate() {
      if (mode === "RUN") {
        try {
          let result = math.evaluate(input);
          lastAns = result;
          document.getElementById("screen").innerText = result;
          input = "" + result;
        } catch(e) {
          document.getElementById("screen").innerText = "Error";
        }
      } else if (mode === "GRAPH") {
        try {
          let expr = input || "sin(x)";
          let xVals = math.range(-10, 10, 0.1).toArray();
          let yVals = xVals.map(x => {
            try { return math.evaluate(expr, {x:x}); }
            catch { return null; }
          });
          Plotly.newPlot('graph', [{x:xVals, y:yVals, mode:'lines'}], {margin:{t:0}});
          document.getElementById("screen").innerText = "Graph: y=" + expr;
        } catch(e) {
          document.getElementById("screen").innerText = "Graph Error";
        }
      } else {
        document.getElementById("screen").innerText = "Mode " + mode + " not yet implemented";
      }
    }
  </script>
</body>
</html>
